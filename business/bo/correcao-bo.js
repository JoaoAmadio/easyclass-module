"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.CorrecaoAtividadeBO = void 0;
const typeorm_1 = require("typeorm");
const defaultDAO_1 = require("../core/dao/defaultDAO");
const respostaAtividade_1 = require("../../entities/respostaAtividade");
const correcaoRespostaAtividade_1 = require("../../entities/correcaoRespostaAtividade");
class CorrecaoAtividadeBO extends defaultDAO_1.DefaultDAO {
    constructor() {
        super();
        this.correcaoAtividadeRepositorio = (0, typeorm_1.getRepository)(correcaoRespostaAtividade_1.default);
    }
    async buscaPorRespostaAtividade(respostaAtividade) {
        const { idRespostaAtividade } = respostaAtividade;
        return this.correcaoAtividadeRepositorio.createQueryBuilder("correcaoRespostaAtividade")
            .innerJoinAndSelect("correcaoRespostaAtividade.respostaAtividade", "respostaAtividade")
            .innerJoinAndSelect("correcaoRespostaAtividade.autor", "autor")
            // Resposta Atividade
            .innerJoinAndSelect("respostaAtividade.atividade", "atividade")
            .innerJoinAndSelect("respostaAtividade.aluno", "aluno")
            .innerJoinAndSelect("atividade.disciplina", "disciplina")
            .innerJoinAndSelect("atividade.autor", "atividade_autor")
            .innerJoinAndSelect("atividade.curso", "curso")
            .leftJoinAndSelect("respostaAtividade.respostaAtividadeItens", "respostaAtividadeItens")
            .leftJoinAndSelect("respostaAtividadeItens.itemAtividade", "itemAtividade")
            .leftJoinAndSelect("itemAtividade.subitensItemAtividade", "itemAtividade_subitensItemAtividade")
            .leftJoinAndSelect("atividade.alunos", "alunos")
            .leftJoinAndSelect("atividade.itensAtividade", "itensAtividade")
            .leftJoinAndSelect("itensAtividade.subitensItemAtividade", "subitensItemAtividade")
            // Itens
            .leftJoinAndSelect("correcaoRespostaAtividade.correcaoAtividadeItens", "correcaoAtividadeItens")
            .leftJoinAndSelect("correcaoAtividadeItens.respostaAtividadeItem", "correcaoAtividadeItens_respostaAtividadeItem")
            .leftJoinAndSelect("correcaoAtividadeItens_respostaAtividadeItem.itemAtividade", "respostaAtividadeItem_itemAtividade")
            .leftJoinAndSelect("respostaAtividadeItem_itemAtividade.subitensItemAtividade", "respostaAtividadeItem_itemAtividade_subitensItemAtividade")
            .where("respostaAtividade.idRespostaAtividade = :idRespostaAtividade", { idRespostaAtividade })
            .getOne();
    }
    async buscaPorID(idCorrecaoRespostaAtividade) {
        return this.correcaoAtividadeRepositorio.createQueryBuilder("correcaoRespostaAtividade")
            .innerJoinAndSelect("correcaoRespostaAtividade.respostaAtividade", "respostaAtividade")
            .innerJoinAndSelect("correcaoRespostaAtividade.autor", "autor")
            // Resposta Atividade
            .innerJoinAndSelect("respostaAtividade.atividade", "atividade")
            .innerJoinAndSelect("respostaAtividade.aluno", "aluno")
            .innerJoinAndSelect("atividade.disciplina", "disciplina")
            .innerJoinAndSelect("atividade.autor", "atividade_autor")
            .innerJoinAndSelect("atividade.curso", "curso")
            .leftJoinAndSelect("respostaAtividade.respostaAtividadeItens", "respostaAtividadeItens")
            .leftJoinAndSelect("respostaAtividadeItens.itemAtividade", "itemAtividade")
            .leftJoinAndSelect("itemAtividade.subitensItemAtividade", "itemAtividade_subitensItemAtividade")
            .leftJoinAndSelect("atividade.alunos", "alunos")
            .leftJoinAndSelect("atividade.itensAtividade", "itensAtividade")
            .leftJoinAndSelect("itensAtividade.subitensItemAtividade", "subitensItemAtividade")
            // Itens
            .leftJoinAndSelect("correcaoRespostaAtividade.correcaoAtividadeItens", "correcaoAtividadeItens")
            .leftJoinAndSelect("correcaoAtividadeItens.respostaAtividadeItem", "correcaoAtividadeItens_respostaAtividadeItem")
            .leftJoinAndSelect("correcaoAtividadeItens_respostaAtividadeItem.itemAtividade", "respostaAtividadeItem_itemAtividade")
            .leftJoinAndSelect("respostaAtividadeItem_itemAtividade.subitensItemAtividade", "respostaAtividadeItem_itemAtividade_subitensItemAtividade")
            .where("correcaoRespostaAtividade.idCorrecaoRespostaAtividade = :idCorrecaoRespostaAtividade", { idCorrecaoRespostaAtividade })
            .getOne();
    }
    async buscaPorRespostaAtividadeSimples(respostaAtividade) {
        const { idRespostaAtividade } = respostaAtividade;
        return this.correcaoAtividadeRepositorio.createQueryBuilder("correcaoRespostaAtividade")
            .innerJoinAndSelect("correcaoRespostaAtividade.respostaAtividade", "respostaAtividade")
            .innerJoinAndSelect("correcaoRespostaAtividade.autor", "autor")
            // Resposta Atividade
            .innerJoinAndSelect("respostaAtividade.atividade", "atividade")
            .innerJoinAndSelect("respostaAtividade.aluno", "aluno")
            .innerJoinAndSelect("atividade.disciplina", "disciplina")
            .innerJoinAndSelect("atividade.autor", "atividade_autor")
            .innerJoinAndSelect("atividade.curso", "curso")
            .leftJoinAndSelect("respostaAtividade.respostaAtividadeItens", "respostaAtividadeItens")
            .leftJoinAndSelect("respostaAtividadeItens.itemAtividade", "itemAtividade")
            .leftJoinAndSelect("itemAtividade.subitensItemAtividade", "itemAtividade_subitensItemAtividade")
            .leftJoinAndSelect("atividade.alunos", "alunos")
            .leftJoinAndSelect("atividade.itensAtividade", "itensAtividade")
            .leftJoinAndSelect("itensAtividade.subitensItemAtividade", "subitensItemAtividade")
            .where("respostaAtividade.idRespostaAtividade = :idRespostaAtividade AND respostaAtividade.tempoFim IS NOT NULL AND NOW() >= correcaoRespostaAtividade.dataEntregaCorrecao", { idRespostaAtividade })
            .getOne();
    }
    async buscaPorRespostaAtividadeRelatorio(atividade) {
        const { idAtividade } = atividade;
        return this.correcaoAtividadeRepositorio.createQueryBuilder("correcaoRespostaAtividade")
            .innerJoinAndSelect("correcaoRespostaAtividade.respostaAtividade", "respostaAtividade")
            .innerJoinAndSelect("correcaoRespostaAtividade.autor", "autor")
            // Resposta Atividade
            .innerJoinAndSelect("respostaAtividade.atividade", "atividade")
            .innerJoinAndSelect("respostaAtividade.aluno", "aluno")
            .innerJoinAndSelect("atividade.disciplina", "disciplina")
            .innerJoinAndSelect("atividade.autor", "atividade_autor")
            .innerJoinAndSelect("atividade.curso", "curso")
            .leftJoinAndSelect("respostaAtividade.respostaAtividadeItens", "respostaAtividadeItens")
            .leftJoinAndSelect("respostaAtividadeItens.itemAtividade", "itemAtividade")
            .leftJoinAndSelect("itemAtividade.subitensItemAtividade", "itemAtividade_subitensItemAtividade")
            .leftJoinAndSelect("atividade.alunos", "alunos")
            .leftJoinAndSelect("atividade.itensAtividade", "itensAtividade")
            .leftJoinAndSelect("itensAtividade.subitensItemAtividade", "subitensItemAtividade")
            // Itens
            .leftJoinAndSelect("correcaoRespostaAtividade.correcaoAtividadeItens", "correcaoAtividadeItens")
            .leftJoinAndSelect("correcaoAtividadeItens.respostaAtividadeItem", "correcaoAtividadeItens_respostaAtividadeItem")
            .leftJoinAndSelect("correcaoAtividadeItens_respostaAtividadeItem.itemAtividade", "respostaAtividadeItem_itemAtividade")
            .leftJoinAndSelect("respostaAtividadeItem_itemAtividade.subitensItemAtividade", "respostaAtividadeItem_itemAtividade_subitensItemAtividade")
            .where("atividade.idAtividade = :idAtividade AND correcaoRespostaAtividade.dataEntregaCorrecao IS NOT NULL", { idAtividade })
            .getMany();
    }
    async listaRespostaAtividadeDisponivel(disciplina, autor) {
        const { ra } = autor;
        const { idDisciplina } = disciplina;
        return (0, typeorm_1.getRepository)(respostaAtividade_1.default).createQueryBuilder("respostaAtividade")
            .innerJoinAndSelect("respostaAtividade.atividade", "atividade")
            .innerJoinAndSelect("respostaAtividade.aluno", "aluno")
            .innerJoinAndSelect("atividade.disciplina", "disciplina")
            .innerJoinAndSelect("atividade.autor", "autor")
            .innerJoinAndSelect("atividade.curso", "curso")
            .leftJoinAndSelect("respostaAtividade.respostaAtividadeItens", "respostaAtividadeItens")
            .leftJoinAndSelect("respostaAtividadeItens.itemAtividade", "itemAtividade")
            .leftJoinAndSelect("itemAtividade.subitensItemAtividade", "itemAtividade_subitensItemAtividade")
            .leftJoinAndSelect("atividade.alunos", "alunos")
            .leftJoinAndSelect("atividade.itensAtividade", "itensAtividade")
            .leftJoinAndSelect("itensAtividade.subitensItemAtividade", "subitensItemAtividade")
            .where("disciplina.idDisciplina = :idDisciplina AND autor.ra = :ra AND respostaAtividade.tempoFim", { idDisciplina, ra })
            .getMany();
    }
}
exports.CorrecaoAtividadeBO = CorrecaoAtividadeBO;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29ycmVjYW8tYm8uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJjb3JyZWNhby1iby50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQSxxQ0FBd0M7QUFFeEMsdURBQW9EO0FBTXBELHdFQUFpRTtBQUNqRSx3RkFBaUY7QUFFakYsTUFBYSxtQkFBb0IsU0FBUSx1QkFBVTtJQUUvQztRQUNJLEtBQUssRUFBRSxDQUFDO1FBR0wsaUNBQTRCLEdBQUcsSUFBQSx1QkFBYSxFQUFDLG1DQUF5QixDQUFDLENBQUM7SUFGL0UsQ0FBQztJQUlNLEtBQUssQ0FBQyx5QkFBeUIsQ0FBQyxpQkFBb0M7UUFDdkUsTUFBTSxFQUFFLG1CQUFtQixFQUFFLEdBQUcsaUJBQWlCLENBQUM7UUFDbEQsT0FBTyxJQUFJLENBQUMsNEJBQTRCLENBQUMsa0JBQWtCLENBQUMsMkJBQTJCLENBQUM7YUFDbkYsa0JBQWtCLENBQUMsNkNBQTZDLEVBQUUsbUJBQW1CLENBQUM7YUFDdEYsa0JBQWtCLENBQUMsaUNBQWlDLEVBQUUsT0FBTyxDQUFDO1lBRS9ELHFCQUFxQjthQUNwQixrQkFBa0IsQ0FBQyw2QkFBNkIsRUFBRSxXQUFXLENBQUM7YUFDOUQsa0JBQWtCLENBQUMseUJBQXlCLEVBQUUsT0FBTyxDQUFDO2FBQ3RELGtCQUFrQixDQUFDLHNCQUFzQixFQUFFLFlBQVksQ0FBQzthQUN4RCxrQkFBa0IsQ0FBQyxpQkFBaUIsRUFBRSxpQkFBaUIsQ0FBQzthQUN4RCxrQkFBa0IsQ0FBQyxpQkFBaUIsRUFBRSxPQUFPLENBQUM7YUFDOUMsaUJBQWlCLENBQUMsMENBQTBDLEVBQUUsd0JBQXdCLENBQUM7YUFDdkYsaUJBQWlCLENBQUMsc0NBQXNDLEVBQUUsZUFBZSxDQUFDO2FBQzFFLGlCQUFpQixDQUFDLHFDQUFxQyxFQUFFLHFDQUFxQyxDQUFDO2FBQy9GLGlCQUFpQixDQUFDLGtCQUFrQixFQUFFLFFBQVEsQ0FBQzthQUMvQyxpQkFBaUIsQ0FBQywwQkFBMEIsRUFB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LENBQUM7YUFDeEgsT0FBTyxFQUFFLENBQUM7SUFDbkIsQ0FBQztDQUNKO0FBcElELGtEQW9JQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdldFJlcG9zaXRvcnkgfSBmcm9tIFwidHlwZW9ybVwiO1xyXG5pbXBvcnQgVXN1YXJpbyBmcm9tIFwiLi4vLi4vZW50aXRpZXMvdXN1YXJpb1wiO1xyXG5pbXBvcnQgeyBEZWZhdWx0REFPIH0gZnJvbSBcIi4uL2NvcmUvZGFvL2RlZmF1bHREQU9cIjtcclxuaW1wb3J0IEN1cnNvIGZyb20gXCIuLi8uLi9lbnRpdGllcy9jdXJzb1wiO1xyXG5pbXBvcnQgRGlzY2lwbGluYSBmcm9tIFwiLi4vLi4vZW50aXRpZXMvZGlzY2lwbGluYVwiO1xyXG5pbXBvcnQgQXRpdmlkYWRlIGZyb20gXCIuLi8uLi9lbnRpdGllcy9hdGl2aWRhZGVcIjtcclxuaW1wb3J0IEF0aXZpZGFkZVVzdWFyaW8gZnJvbSBcIi4uLy4uL2VudGl0aWVzL2F0aXZpZGFkZUFsdW5vc1VzdWFyaW9cIjtcclxuaW1wb3J0IERpc2NpcGxpbmFVc3VhcmlvIGZyb20gXCIuLi8uLi9lbnRpdGllcy9kaXNjaXBsaW5hQWx1bm9zVXN1YXJpb1wiO1xyXG5pbXBvcnQgUmVzcG9zdGFBdGl2aWRhZGUgZnJvbSBcIi4uLy4uL2VudGl0aWVzL3Jlc3Bvc3RhQXRpdmlkYWRlXCI7XHJcbmltcG9ydCBDb3JyZWNhb1Jlc3Bvc3RhQXRpdmlkYWRlIGZyb20gXCIuLi8uLi9lbnRpdGllcy9jb3JyZWNhb1Jlc3Bvc3RhQXRpdmlkYWRlXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgQ29ycmVjYW9BdGl2aWRhZGVCTyBleHRlbmRzIERlZmF1bHREQU8ge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHN1cGVyKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGNvcnJlY2FvQXRpdmlkYWRlUmVwb3NpdG9yaW8gPSBnZXRSZXBvc2l0b3J5KENvcnJlY2FvUmVzcG9zdGFBdGl2aWRhZGUpO1xyXG5cclxuICAgIHB1YmxpYyBhc3luYyBidXNjYVBvclJlc3Bvc3RhQXRpdmlkYWRlKHJlc3Bvc3RhQXRpdmlkYWRlOiBSZXNwb3N0YUF0aXZpZGFkZSk6IFByb21pc2U8Q29ycmVjYW9SZXNwb3N0YUF0aXZpZGFkZSB8IG51bGw+IHtcclxuICAgICAgICBjb25zdCB7IGlkUmVzcG9zdGFBdGl2aWRhZGUgfSA9IHJlc3Bvc3RhQXRpdmlkYWRlO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNvcnJlY2FvQXRpdmlkYWRlUmVwb3NpdG9yaW8uY3JlYXRlUXVlcnlCdWlsZGVyKFwiY29ycmVjYW9SZXNwb3N0YUF0aXZpZGFkZVwiKVxyXG4gICAgICAgICAgICAuaW5uZXJKb2luQW5kU2VsZWN0KFwiY29ycmVjYW9SZXNwb3N0YUF0aXZpZGFkZS5yZXNwb3N0YUF0aXZpZGFkZVwiLCBcInJlc3Bvc3RhQXRpdmlkYWRlXCIpXHJcbiAgICAgICAgICAgIC5pbm5lckpvaW5BbmRTZWxlY3QoXCJjb3JyZWNhb1Jlc3Bvc3RhQXRpdmlkYWRlLmF1dG9yXCIsIFwiYXV0b3JcIilcclxuXHJcbiAgICAgICAgICAgIC8vIFJlc3Bvc3RhIEF0aXZpZGFkZVxyXG4gICAgICAgICAgICAuaW5uZXJKb2luQW5kU2VsZWN0KFwicmVzcG9zdGFBdGl2aWRhZGUuYXRpdmlkYWRlXCIsIFwiYXRpdmlkYWRlXCIpXHJcbiAgICAgICAgICAgIC5pbm5lckpvaW5BbmRTZWxlY3QoXCJyZXNwb3N0YUF0aXZpZGFkZS5hbHVub1wiLCBcImFsdW5vXCIpXHJcbiAgICAgICAgICAgIC5pbm5lckpvaW5BbmRTZWxlY3QoXCJhdGl2aWRhZGUuZGlzY2lwbGluYVwiLCBcImRpc2NpcGxpbmFcIilcclxuICAgICAgICAgICAgLmlubmVySm9pbkFuZFNlbGVjdChcImF0aXZpZGFkZS5hdXRvclwiLCBcImF0aXZpZGFkZV9hdXRvclwiKVxyXG4gICAgICAgICAgICAuaW5uZXJKb2luQW5kU2VsZWN0KFwiYXRpdmlkYWRlLmN1cnNvXCIsIFwiY3Vyc29cIilcclxuICAgICAgICAgICAgLmxlZnRKb2luQW5kU2VsZWN0KFwicmVzcG9zdGFBdGl2aWRhZGUucmVzcG9zdGFBdGl2aWRhZGVJdGVuc1wiLCBcInJlc3Bvc3RhQXRpdmlkYWRlSXRlbnNcIilcclxuICAgICAgICAgICAgLmxlZnRKb2luQW5kU2VsZWN0KFwicmVzcG9zdGFBdGl2aWRhZGVJdGVucy5pdGVtQXRpdmlkYWRlXCIsIFwiaXRlbUF0aXZpZGFkZVwiKVxyXG4gICAgICAgICAgICAubGVmdEpvaW5BbmRTZWxlY3QoXCJpdGVtQXRpdmlkYWRlLnN1Yml0ZW5zSXRlbUF0aXZpZGFkZVwiLCBcIml0ZW1BdGl2aWRhZGVfc3ViaXRlbnNJdGVtQXRpdmlkYWRlXCIpXHJcbiAgICAgICAgICAgIC5sZWZ0Sm9pbkFuZFNlbGVjdChcImF0aXZpZGFkZS5hbHVub3NcIiwgXCJhbHVub3NcIilcclxuICAgICAgICAgICAgLmxlZnRKb2luQW5kU2VsZWN0KFwiYXRpdmlkYWRlLml0ZW5zQXRpdmlkYWRlXCIsIFwiaXRlbnNBdGl2aWRhZGVcIilcclxuICAgICAgICAgICAgLmxlZnRKb2luQW5kU2VsZWN0KFwiaXRlbnNBdGl2aWRhZGUuc3ViaXRlbnNJdGVtQXRpdmlkYWRlXCIsIFwic3ViaXRlbnNJdGVtQXRpdmlkYWRlXCIpXHJcblxyXG4gICAgICAgICAgICAvLyBJdGVuc1xyXG4gICAgICAgICAgICAubGVmdEpvaW5BbmRTZWxlY3QoXCJjb3JyZWNhb1Jlc3Bvc3RhQXRpdmlkYWRlLmNvcnJlY2FvQXRpdmlkYWRlSXRlbnNcIiwgXCJjb3JyZWNhb0F0aXZpZGFkZUl0ZW5zXCIpXHJcbiAgICAgICAgICAgIC5sZWZ0Sm9pbkFuZFNlbGVjdChcImNvcnJlY2FvQXRpdmlkYWRlSXRlbnMucmVzcG9zdGFBdGl2aWRhZGVJdGVtXCIsIFwiY29ycmVjYW9BdGl2aWRhZGVJdGVuc19yZXNwb3N0YUF0aXZpZGFkZUl0ZW1cIilcclxuICAgICAgICAgICAgLmxlZnRKb2luQW5kU2VsZWN0KFwiY29ycmVjYW9BdGl2aWRhZGVJdGVuc19yZXNwb3N0YUF0aXZpZGFkZUl0ZW0uaXRlbUF0aXZpZGFkZVwiLCBcInJlc3Bvc3RhQXRpdmlkYWRlSXRlbV9pdGVtQXRpdmlkYWRlXCIpXHJcbiAgICAgICAgICAgIC5sZWZ0Sm9pbkFuZFNlbGVjdChcInJlc3Bvc3RhQXRpdmlkYWRlSXRlbV9pdGVtQXRpdmlkYWRlLnN1Yml0ZW5zSXRlbUF0aXZpZGFkZVwiLCBcInJlc3Bvc3RhQXRpdmlkYWRlSXRlbV9pdGVtQXRpdmlkYWRlX3N1Yml0ZW5zSXRlbUF0aXZpZGFkZVwiKVxyXG4gICAgICAgICAgICAud2hlcmUoXCJyZXNwb3N0YUF0aXZpZGFkZS5pZFJlc3Bvc3RhQXRpdmlkYWRlID0gOmlkUmVzcG9zdGFBdGl2aWRhZGVcIiwgeyBpZFJlc3Bvc3RhQXRpdmlkYWRlIH0pXHJcbiAgICAgICAgICAgIC5nZXRPbmUoKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgYXN5bmMgYnVzY2FQb3JJRChpZENvcnJlY2FvUmVzcG9zdGFBdGl2aWRhZGU6IG51bWJlcik6IFByb21pc2U8Q29ycmVjYW9SZXNwb3N0YUF0aXZpZGFkZSB8IG51bGw+IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jb3JyZWNhb0F0aXZpZGFkZVJlcG9zaXRvcmlvLmNyZWF0ZVF1ZXJ5QnVpbGRlcihcImNvcnJlY2FvUmVzcG9zdGFBdGl2aWRhZGVcIilcclxuICAgICAgICAgICAgLmlubmVySm9pbkFuZFNlbGVjdChcImNvcnJlY2FvUmVzcG9zdGFBdGl2aWRhZGUucmVzcG9zdGFBdGl2aWRhZGVcIiwgXCJyZXNwb3N0YUF0aXZpZGFkZVwiKVxyXG4gICAgICAgICAgICAuaW5uZXJKb2luQW5kU2VsZWN0KFwiY29ycmVjYW9SZXNwb3N0YUF0aXZpZGFkZS5hdXRvclwiLCBcImF1dG9yXCIpXHJcblxyXG4gICAgICAgICAgICAvLyBSZXNwb3N0YSBBdGl2aWRhZGVcclxuICAgICAgICAgICAgLmlubmVySm9pbkFuZFNlbGVjdChcInJlc3Bvc3RhQXRpdmlkYWRlLmF0aXZpZGFkZVwiLCBcImF0aXZpZGFkZVwiKVxyXG4gICAgICAgICAgICAuaW5uZXJKb2luQW5kU2VsZWN0KFwicmVzcG9zdGFBdGl2aWRhZGUuYWx1bm9cIiwgXCJhbHVub1wiKVxyXG4gICAgICAgICAgICAuaW5uZXJKb2luQW5kU2VsZWN0KFwiYXRpdmlkYWRlLmRpc2NpcGxpbmFcIiwgXCJkaXNjaXBsaW5hXCIpXHJcbiAgICAgICAgICAgIC5pbm5lckpvaW5BbmRTZWxlY3QoXCJhdGl2aWRhZGUuYXV0b3JcIiwgXCJhdGl2aWRhZGVfYXV0b3JcIilcclxuICAgICAgICAgICAgLmlubmVySm9pbkFuZFNlbGVjdChcImF0aXZpZGFkZS5jdXJzb1wiLCBcImN1cnNvXCIpXHJcbiAgICAgICAgICAgIC5sZWZ0Sm9pbkFuZFNlbGVjdChcInJlc3Bvc3RhQXRpdmlkYWRlLnJlc3Bvc3RhQXRpdmlkYWRlSXRlbnNcIiwgXCJyZXNwb3N0YUF0aXZpZGFkZUl0ZW5zXCIpXHJcbiAgICAgICAgICAgIC5sZWZ0Sm9pbkFuZFNlbGVjdChcInJlc3Bvc3RhQXRpdmlkYWRlSXRlbnMuaXRlbUF0aXZpZGFkZVwiLCBcIml0ZW1BdGl2aWRhZGVcIilcclxuICAgICAgICAgICAgLmxlZnRKb2luQW5kU2VsZWN0KFwiaXRlbUF0aXZpZGFkZS5zdWJpdGVuc0l0ZW1BdGl2aWRhZGVcIiwgXCJpdGVtQXRpdmlkYWRlX3N1Yml0ZW5zSXRlbUF0aXZpZGFkZVwiKVxyXG4gICAgICAgICAgICAubGVmdEpvaW5BbmRTZWxlY3QoXCJhdGl2aWRhZGUuYWx1bm9zXCIsIFwiYWx1bm9zXCIpXHJcbiAgICAgICAgICAgIC5sZWZ0Sm9pbkFuZFNlbGVjdChcImF0aXZpZGFkZS5pdGVuc0F0aXZpZGFkZVwiLCBcIml0ZW5zQXRpdmlkYWRlXCIpXHJcbiAgICAgICAgICAgIC5sZWZ0Sm9pbkFuZFNlbGVjdChcIml0ZW5zQXRpdmlkYWRlLnN1Yml0ZW5zSXRlbUF0aXZpZGFkZVwiLCBcInN1Yml0ZW5zSXRlbUF0aXZpZGFkZVwiKVxyXG5cclxuICAgICAgICAgICAgLy8gSXRlbnNcclxuICAgICAgICAgICAgLmxlZnRKb2luQW5kU2VsZWN0KFwiY29ycmVjYW9SZXNwb3N0YUF0aXZpZGFkZS5jb3JyZWNhb0F0aXZpZGFkZUl0ZW5zXCIsIFwiY29ycmVjYW9BdGl2aWRhZGVJdGVuc1wiKVxyXG4gICAgICAgICAgICAubGVmdEpvaW5BbmRTZWxlY3QoXCJjb3JyZWNhb0F0aXZpZGFkZUl0ZW5zLnJlc3Bvc3RhQXRpdmlkYWRlSXRlbVwiLCBcImNvcnJlY2FvQXRpdmlkYWRlSXRlbnNfcmVzcG9zdGFBdGl2aWRhZGVJdGVtXCIpXHJcbiAgICAgICAgICAgIC5sZWZ0Sm9pbkFuZFNlbGVjdChcImNvcnJlY2FvQXRpdmlkYWRlSXRlbnNfcmVzcG9zdGFBdGl2aWRhZGVJdGVtLml0ZW1BdGl2aWRhZGVcIiwgXCJyZXNwb3N0YUF0aXZpZGFkZUl0ZW1faXRlbUF0aXZpZGFkZVwiKVxyXG4gICAgICAgICAgICAubGVmdEpvaW5BbmRTZWxlY3QoXCJyZXNwb3N0YUF0aXZpZGFkZUl0ZW1faXRlbUF0aXZpZGFkZS5zdWJpdGVuc0l0ZW1BdGl2aWRhZGVcIiwgXCJyZXNwb3N0YUF0aXZpZGFkZUl0ZW1faXRlbUF0aXZpZGFkZV9zdWJpdGVuc0l0ZW1BdGl2aWRhZGVcIilcclxuICAgICAgICAgICAgLndoZXJlKFwiY29ycmVjYW9SZXNwb3N0YUF0aXZpZGFkZS5pZENvcnJlY2FvUmVzcG9zdGFBdGl2aWRhZGUgPSA6aWRDb3JyZWNhb1Jlc3Bvc3RhQXRpdmlkYWRlXCIsIHsgaWRDb3JyZWNhb1Jlc3Bvc3RhQXRpdmlkYWRlIH0pXHJcbiAgICAgICAgICAgIC5nZXRPbmUoKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgYXN5bmMgYnVzY2FQb3JSZXNwb3N0YUF0aXZpZGFkZVNpbXBsZXMocmVzcG9zdGFBdGl2aWRhZGU6IFJlc3Bvc3RhQXRpdmlkYWRlKTogUHJvbWlzZTxDb3JyZWNhb1Jlc3Bvc3RhQXRpdmlkYWRlIHwgbnVsbD4ge1xyXG4gICAgICAgIGNvbnN0IHsgaWRSZXNwb3N0YUF0aXZpZGFkZSB9ID0gcmVzcG9zdGFBdGl2aWRhZGU7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY29ycmVjYW9BdGl2aWRhZGVSZXBvc2l0b3Jpby5jcmVhdGVRdWVyeUJ1aWxkZXIoXCJjb3JyZWNhb1Jlc3Bvc3RhQXRpdmlkYWRlXCIpXHJcbiAgICAgICAgICAgIC5pbm5lckpvaW5BbmRTZWxlY3QoXCJjb3JyZWNhb1Jlc3Bvc3RhQXRpdmlkYWRlLnJlc3Bvc3RhQXRpdmlkYWRlXCIsIFwicmVzcG9zdGFBdGl2aWRhZGVcIilcclxuICAgICAgICAgICAgLmlubmVySm9pbkFuZFNlbGVjdChcImNvcnJlY2FvUmVzcG9zdGFBdGl2aWRhZGUuYXV0b3JcIiwgXCJhdXRvclwiKVxyXG5cclxuICAgICAgICAgICAgLy8gUmVzcG9zdGEgQXRpdmlkYWRlXHJcbiAgICAgICAgICAgIC5pbm5lckpvaW5BbmRTZWxlY3QoXCJyZXNwb3N0YUF0aXZpZGFkZS5hdGl2aWRhZGVcIiwgXCJhdGl2aWRhZGVcIilcclxuICAgICAgICAgICAgLmlubmVySm9pbkFuZFNlbGVjdChcInJlc3Bvc3RhQXRpdmlkYWRlLmFsdW5vXCIsIFwiYWx1bm9cIilcclxuICAgICAgICAgICAgLmlubmVySm9pbkFuZFNlbGVjdChcImF0aXZpZGFkZS5kaXNjaXBsaW5hXCIsIFwiZGlzY2lwbGluYVwiKVxyXG4gICAgICAgICAgICAuaW5uZXJKb2luQW5kU2VsZWN0KFwiYXRpdmlkYWRlLmF1dG9yXCIsIFwiYXRpdmlkYWRlX2F1dG9yXCIpXHJcbiAgICAgICAgICAgIC5pbm5lckpvaW5BbmRTZWxlY3QoXCJhdGl2aWRhZGUuY3Vyc29cIiwgXCJjdXJzb1wiKVxyXG4gICAgICAgICAgICAubGVmdEpvaW5BbmRTZWxlY3QoXCJyZXNwb3N0YUF0aXZpZGFkZS5yZXNwb3N0YUF0aXZpZGFkZUl0ZW5zXCIsIFwicmVzcG9zdGFBdGl2aWRhZGVJdGVuc1wiKVxyXG4gICAgICAgICAgICAubGVmdEpvaW5BbmRTZWxlY3QoXCJyZXNwb3N0YUF0aXZpZGFkZUl0ZW5zLml0ZW1BdGl2aWRhZGVcIiwgXCJpdGVtQXRpdmlkYWRlXCIpXHJcbiAgICAgICAgICAgIC5sZWZ0Sm9pbkFuZFNlbGVjdChcIml0ZW1BdGl2aWRhZGUuc3ViaXRlbnNJdGVtQXRpdmlkYWRlXCIsIFwiaXRlbUF0aXZpZGFkZV9zdWJpdGVuc0l0ZW1BdGl2aWRhZGVcIilcclxuICAgICAgICAgICAgLmxlZnRKb2luQW5kU2VsZWN0KFwiYXRpdmlkYWRlLmFsdW5vc1wiLCBcImFsdW5vc1wiKVxyXG4gICAgICAgICAgICAubGVmdEpvaW5BbmRTZWxlY3QoXCJhdGl2aWRhZGUuaXRlbnNBdGl2aWRhZGVcIiwgXCJpdGVuc0F0aXZpZGFkZVwiKVxyXG4gICAgICAgICAgICAubGVmdEpvaW5BbmRTZWxlY3QoXCJpdGVuc0F0aXZpZGFkZS5zdWJpdGVuc0l0ZW1BdGl2aWRhZGVcIiwgXCJzdWJpdGVuc0l0ZW1BdGl2aWRhZGVcIilcclxuXHJcbiAgICAgICAgICAgIC53aGVyZShcInJlc3Bvc3RhQXRpdmlkYWRlLmlkUmVzcG9zdGFBdGl2aWRhZGUgPSA6aWRSZXNwb3N0YUF0aXZpZGFkZSBBTkQgcmVzcG9zdGFBdGl2aWRhZGUudGVtcG9GaW0gSVMgTk9UIE5VTEwgQU5EIE5PVygpID49IGNvcnJlY2FvUmVzcG9zdGFBdGl2aWRhZGUuZGF0YUVudHJlZ2FDb3JyZWNhb1wiLCB7IGlkUmVzcG9zdGFBdGl2aWRhZGUgfSlcclxuICAgICAgICAgICAgLmdldE9uZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBhc3luYyBidXNjYVBvclJlc3Bvc3RhQXRpdmlkYWRlUmVsYXRvcmlvKGF0aXZpZGFkZTogQXRpdmlkYWRlKTogUHJvbWlzZTxDb3JyZWNhb1Jlc3Bvc3RhQXRpdmlkYWRlW10gfCBudWxsPiB7XHJcbiAgICAgICAgY29uc3QgeyBpZEF0aXZpZGFkZSB9ID0gYXRpdmlkYWRlO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNvcnJlY2FvQXRpdmlkYWRlUmVwb3NpdG9yaW8uY3JlYXRlUXVlcnlCdWlsZGVyKFwiY29ycmVjYW9SZXNwb3N0YUF0aXZpZGFkZVwiKVxyXG4gICAgICAgICAgICAuaW5uZXJKb2luQW5kU2VsZWN0KFwiY29ycmVjYW9SZXNwb3N0YUF0aXZpZGFkZS5yZXNwb3N0YUF0aXZpZGFkZVwiLCBcInJlc3Bvc3RhQXRpdmlkYWRlXCIpXHJcbiAgICAgICAgICAgIC5pbm5lckpvaW5BbmRTZWxlY3QoXCJjb3JyZWNhb1Jlc3Bvc3RhQXRpdmlkYWRlLmF1dG9yXCIsIFwiYXV0b3JcIilcclxuXHJcbiAgICAgICAgICAgIC8vIFJlc3Bvc3RhIEF0aXZpZGFkZVxyXG4gICAgICAgICAgICAuaW5uZXJKb2luQW5kU2VsZWN0KFwicmVzcG9zdGFBdGl2aWRhZGUuYXRpdmlkYWRlXCIsIFwiYXRpdmlkYWRlXCIpXHJcbiAgICAgICAgICAgIC5pbm5lckpvaW5BbmRTZWxlY3QoXCJyZXNwb3N0YUF0aXZpZGFkZS5hbHVub1wiLCBcImFsdW5vXCIpXHJcbiAgICAgICAgICAgIC5pbm5lckpvaW5BbmRTZWxlY3QoXCJhdGl2aWRhZGUuZGlzY2lwbGluYVwiLCBcImRpc2NpcGxpbmFcIilcclxuICAgICAgICAgICAgLmlubmVySm9pbkFuZFNlbGVjdChcImF0aXZpZGFkZS5hdXRvclwiLCBcImF0aXZpZGFkZV9hdXRvclwiKVxyXG4gICAgICAgICAgICAuaW5uZXJKb2luQW5kU2VsZWN0KFwiYXRpdmlkYWRlLmN1cnNvXCIsIFwiY3Vyc29cIilcclxuICAgICAgICAgICAgLmxlZnRKb2luQW5kU2VsZWN0KFwicmVzcG9zdGFBdGl2aWRhZGUucmVzcG9zdGFBdGl2aWRhZGVJdGVuc1wiLCBcInJlc3Bvc3RhQXRpdmlkYWRlSXRlbnNcIilcclxuICAgICAgICAgICAgLmxlZnRKb2luQW5kU2VsZWN0KFwicmVzcG9zdGFBdGl2aWRhZGVJdGVucy5pdGVtQXRpdmlkYWRlXCIsIFwiaXRlbUF0aXZpZGFkZVwiKVxyXG4gICAgICAgICAgICAubGVmdEpvaW5BbmRTZWxlY3QoXCJpdGVtQXRpdmlkYWRlLnN1Yml0ZW5zSXRlbUF0aXZpZGFkZVwiLCBcIml0ZW1BdGl2aWRhZGVfc3ViaXRlbnNJdGVtQXRpdmlkYWRlXCIpXHJcbiAgICAgICAgICAgIC5sZWZ0Sm9pbkFuZFNlbGVjdChcImF0aXZpZGFkZS5hbHVub3NcIiwgXCJhbHVub3NcIilcclxuICAgICAgICAgICAgLmxlZnRKb2luQW5kU2VsZWN0KFwiYXRpdmlkYWRlLml0ZW5zQXRpdmlkYWRlXCIsIFwiaXRlbnNBdGl2aWRhZGVcIilcclxuICAgICAgICAgICAgLmxlZnRKb2luQW5kU2VsZWN0KFwiaXRlbnNBdGl2aWRhZGUuc3ViaXRlbnNJdGVtQXRpdmlkYWRlXCIsIFwic3ViaXRlbnNJdGVtQXRpdmlkYWRlXCIpXHJcblxyXG4gICAgICAgICAgICAvLyBJdGVuc1xyXG4gICAgICAgICAgICAubGVmdEpvaW5BbmRTZWxlY3QoXCJjb3JyZWNhb1Jlc3Bvc3RhQXRpdmlkYWRlLmNvcnJlY2FvQXRpdmlkYWRlSXRlbnNcIiwgXCJjb3JyZWNhb0F0aXZpZGFkZUl0ZW5zXCIpXHJcbiAgICAgICAgICAgIC5sZWZ0Sm9pbkFuZFNlbGVjdChcImNvcnJlY2FvQXRpdmlkYWRlSXRlbnMucmVzcG9zdGFBdGl2aWRhZGVJdGVtXCIsIFwiY29ycmVjYW9BdGl2aWRhZGVJdGVuc19yZXNwb3N0YUF0aXZpZGFkZUl0ZW1cIilcclxuICAgICAgICAgICAgLmxlZnRKb2luQW5kU2VsZWN0KFwiY29ycmVjYW9BdGl2aWRhZGVJdGVuc19yZXNwb3N0YUF0aXZpZGFkZUl0ZW0uaXRlbUF0aXZpZGFkZVwiLCBcInJlc3Bvc3RhQXRpdmlkYWRlSXRlbV9pdGVtQXRpdmlkYWRlXCIpXHJcbiAgICAgICAgICAgIC5sZWZ0Sm9pbkFuZFNlbGVjdChcInJlc3Bvc3RhQXRpdmlkYWRlSXRlbV9pdGVtQXRpdmlkYWRlLnN1Yml0ZW5zSXRlbUF0aXZpZGFkZVwiLCBcInJlc3Bvc3RhQXRpdmlkYWRlSXRlbV9pdGVtQXRpdmlkYWRlX3N1Yml0ZW5zSXRlbUF0aXZpZGFkZVwiKVxyXG4gICAgICAgICAgICAud2hlcmUoXCJhdGl2aWRhZGUuaWRBdGl2aWRhZGUgPSA6aWRBdGl2aWRhZGUgQU5EIGNvcnJlY2FvUmVzcG9zdGFBdGl2aWRhZGUuZGF0YUVudHJlZ2FDb3JyZWNhbyBJUyBOT1QgTlVMTFwiLCB7IGlkQXRpdmlkYWRlIH0pXHJcbiAgICAgICAgICAgIC5nZXRNYW55KCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGFzeW5jIGxpc3RhUmVzcG9zdGFBdGl2aWRhZGVEaXNwb25pdmVsKGRpc2NpcGxpbmE6IERpc2NpcGxpbmEsIGF1dG9yOiBVc3VhcmlvKTogIFByb21pc2U8UmVzcG9zdGFBdGl2aWRhZGVbXSB8IG51bGw+ICB7XHJcbiAgICAgICAgY29uc3QgeyByYSB9ID0gYXV0b3I7XHJcbiAgICAgICAgY29uc3QgeyBpZERpc2NpcGxpbmEgfSA9IGRpc2NpcGxpbmE7XHJcbiAgICAgICAgcmV0dXJuIGdldFJlcG9zaXRvcnkoUmVzcG9zdGFBdGl2aWRhZGUpLmNyZWF0ZVF1ZXJ5QnVpbGRlcihcInJlc3Bvc3RhQXRpdmlkYWRlXCIpXHJcbiAgICAgICAgICAgIC5pbm5lckpvaW5BbmRTZWxlY3QoXCJyZXNwb3N0YUF0aXZpZGFkZS5hdGl2aWRhZGVcIiwgXCJhdGl2aWRhZGVcIilcclxuICAgICAgICAgICAgLmlubmVySm9pbkFuZFNlbGVjdChcInJlc3Bvc3RhQXRpdmlkYWRlLmFsdW5vXCIsIFwiYWx1bm9cIilcclxuICAgICAgICAgICAgLmlubmVySm9pbkFuZFNlbGVjdChcImF0aXZpZGFkZS5kaXNjaXBsaW5hXCIsIFwiZGlzY2lwbGluYVwiKVxyXG4gICAgICAgICAgICAuaW5uZXJKb2luQW5kU2VsZWN0KFwiYXRpdmlkYWRlLmF1dG9yXCIsIFwiYXV0b3JcIilcclxuICAgICAgICAgICAgLmlubmVySm9pbkFuZFNlbGVjdChcImF0aXZpZGFkZS5jdXJzb1wiLCBcImN1cnNvXCIpXHJcbiAgICAgICAgICAgIC5sZWZ0Sm9pbkFuZFNlbGVjdChcInJlc3Bvc3RhQXRpdmlkYWRlLnJlc3Bvc3RhQXRpdmlkYWRlSXRlbnNcIiwgXCJyZXNwb3N0YUF0aXZpZGFkZUl0ZW5zXCIpXHJcbiAgICAgICAgICAgIC5sZWZ0Sm9pbkFuZFNlbGVjdChcInJlc3Bvc3RhQXRpdmlkYWRlSXRlbnMuaXRlbUF0aXZpZGFkZVwiLCBcIml0ZW1BdGl2aWRhZGVcIilcclxuICAgICAgICAgICAgLmxlZnRKb2luQW5kU2VsZWN0KFwiaXRlbUF0aXZpZGFkZS5zdWJpdGVuc0l0ZW1BdGl2aWRhZGVcIiwgXCJpdGVtQXRpdmlkYWRlX3N1Yml0ZW5zSXRlbUF0aXZpZGFkZVwiKVxyXG4gICAgICAgICAgICAubGVmdEpvaW5BbmRTZWxlY3QoXCJhdGl2aWRhZGUuYWx1bm9zXCIsIFwiYWx1bm9zXCIpXHJcbiAgICAgICAgICAgIC5sZWZ0Sm9pbkFuZFNlbGVjdChcImF0aXZpZGFkZS5pdGVuc0F0aXZpZGFkZVwiLCBcIml0ZW5zQXRpdmlkYWRlXCIpXHJcbiAgICAgICAgICAgIC5sZWZ0Sm9pbkFuZFNlbGVjdChcIml0ZW5zQXRpdmlkYWRlLnN1Yml0ZW5zSXRlbUF0aXZpZGFkZVwiLCBcInN1Yml0ZW5zSXRlbUF0aXZpZGFkZVwiKVxyXG4gICAgICAgICAgICAud2hlcmUoXCJkaXNjaXBsaW5hLmlkRGlzY2lwbGluYSA9IDppZERpc2NpcGxpbmEgQU5EIGF1dG9yLnJhID0gOnJhIEFORCByZXNwb3N0YUF0aXZpZGFkZS50ZW1wb0ZpbVwiLCB7IGlkRGlzY2lwbGluYSwgcmEgfSlcclxuICAgICAgICAgICAgLmdldE1hbnkoKTtcclxuICAgIH1cclxufVxyXG4iXX0=